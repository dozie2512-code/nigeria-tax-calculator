# Netlify Configuration for Nigeria Tax Calculator
# This configuration deploys the static tax calculator application

[build]
  # No build command needed - this is a static site
  publish = "."
  
  # Environment variables can be set in Netlify UI for Firebase configuration
  # The following are used in index.html:
  # - FIREBASE_API_KEY
  # - FIREBASE_AUTH_DOMAIN
  # - FIREBASE_PROJECT_ID
  # - FIREBASE_STORAGE_BUCKET
  # - FIREBASE_MESSAGING_SENDER_ID
  # - FIREBASE_APP_ID
  # - FIREBASE_MEASUREMENT_ID

# Headers for security and performance
[[headers]]
  for = "/*"
  [headers.values]
    # Security headers
    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
    X-XSS-Protection = "1; mode=block"
    Referrer-Policy = "strict-origin-when-cross-origin"
    
    # Cache control for HTML files (no cache)
    Cache-Control = "public, max-age=0, must-revalidate"

[[headers]]
  for = "/*.css"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Redirects and rewrites
# Handle SPA-like routing - client-side routing in index.html handles these routes
[[redirects]]
  from = "/dashboard"
  to = "/index.html"
  status = 200
  force = false

# Auth routes - both auth.html (root) and auth/index.html exist
# auth.html is the main authentication page used by the application
[[redirects]]
  from = "/auth"
  to = "/auth.html"
  status = 200
  force = false

[[redirects]]
  from = "/login"
  to = "/auth.html"
  status = 200
  force = false

[[redirects]]
  from = "/signup"
  to = "/auth.html"
  status = 200
  force = false

# SPA fallback - serve index.html for unmatched routes (client-side routing)
# This must be last in the redirects list
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

# Note: Firebase Cloud Functions (in /functions directory) are deployed separately to Firebase
# These functions handle Stripe payments and webhooks:
# - createCheckoutSession: Creates Stripe checkout sessions
# - stripeWebhook: Handles Stripe webhook events
# 
# To deploy functions: cd functions && npm run deploy
# Functions are not deployed through Netlify
