<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nigeria Personal Income, Expense & Tax Calculator (2026)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    label { display: block; margin-top: 10px; }
    input { width: 200px; padding: 5px; }
    .group { margin-bottom: 15px; }
    #result { margin-top: 20px; padding: 10px; background-color: #f0f0f0; }
    .add-btn, .remove-btn { margin-left: 10px; }
    .income-list, .deduction-list, .expense-list { margin-bottom: 10px; }
    .item-row { display: flex; align-items: center; margin-bottom: 5px; }
    .item-row input { margin-right: 8px; }
    .section-title { font-weight: bold; margin-bottom: 5px; }
    .totals { margin-top: 10px; margin-bottom: 10px; }
  </style>
</head>
<body>
  <h2>Nigeria Personal Income, Expense & Tax Calculator (from Jan 2026)</h2>
  <div class="group">
    <span class="section-title">Income Sources (Annual)</span>
    <div id="incomeList" class="income-list"></div>
    <button class="add-btn" onclick="addIncome()">Add Income Source</button>
    <div class="totals" id="incomeTotal"></div>
  </div>
  <div class="group">
    <span class="section-title">Deductions (Annual)</span>
    <div id="deductionList" class="deduction-list"></div>
    <button class="add-btn" onclick="addDeduction()">Add Deduction</button>
    <div class="totals" id="deductionTotal"></div>
  </div>
  <div class="group">
    <span class="section-title">Expenses (Annual)</span>
    <div id="expenseList" class="expense-list"></div>
    <button class="add-btn" onclick="addExpense()">Add Expense</button>
    <div class="totals" id="expenseTotal"></div>
  </div>
  <div class="group">
    <label>
      Annual Rent Paid (₦):
      <input type="number" id="rentPaid" value="0" />
    </label>
  </div>
  <button onclick="calculateAll()">Calculate Tax & Net Position</button>
  <div id="result"></div>

  <script>
    window.onload = function() {
      addIncome();
      addDeduction();
      addExpense();
      updateTotals();
    };

    function addIncome(name = "", value = "") {
      const list = document.getElementById('incomeList');
      const row = document.createElement('div');
      row.className = "item-row";
      row.innerHTML = `
        <input type="text" placeholder="Description" value="${name}" />
        <input type="number" placeholder="Amount (₦)" value="${value}" />
        <button class="remove-btn" onclick="this.parentElement.remove(); updateTotals();">Remove</button>
      `;
      list.appendChild(row);
      row.querySelectorAll('input').forEach(input => input.addEventListener('input', updateTotals));
      updateTotals();
    }

    function addDeduction(name = "", value = "") {
      const list = document.getElementById('deductionList');
      const row = document.createElement('div');
      row.className = "item-row";
      row.innerHTML = `
        <input type="text" placeholder="Description" value="${name}" />
        <input type="number" placeholder="Amount (₦)" value="${value}" />
        <button class="remove-btn" onclick="this.parentElement.remove(); updateTotals();">Remove</button>
      `;
      list.appendChild(row);
      row.querySelectorAll('input').forEach(input => input.addEventListener('input', updateTotals));
      updateTotals();
    }

    function addExpense(name = "", value = "") {
      const list = document.getElementById('expenseList');
      const row = document.createElement('div');
      row.className = "item-row";
      row.innerHTML = `
        <input type="text" placeholder="Description" value="${name}" />
        <input type="number" placeholder="Amount (₦)" value="${value}" />
        <button class="remove-btn" onclick="this.parentElement.remove(); updateTotals();">Remove</button>
      `;
      list.appendChild(row);
      row.querySelectorAll('input').forEach(input => input.addEventListener('input', updateTotals));
      updateTotals();
    }

    function getTotal(listId) {
      let total = 0;
      const rows = document.getElementById(listId).children;
      for (let row of rows) {
        const val = parseFloat(row.children[1].value) || 0;
        total += val;
      }
      return total;
    }

    function updateTotals() {
      document.getElementById('incomeTotal').innerText = "Total Income: ₦" + getTotal('incomeList').toLocaleString();
      document.getElementById('deductionTotal').innerText = "Total Deductions: ₦" + getTotal('deductionList').toLocaleString();
      document.getElementById('expenseTotal').innerText = "Total Expenses: ₦" + getTotal('expenseList').toLocaleString();
    }

    function calculateAll() {
      // Income & Deductions
      let gross = getTotal('incomeList');
      let deductions = getTotal('deductionList');
      let expenses = getTotal('expenseList');
      let rent = parseFloat(document.getElementById('rentPaid').value) || 0;

      // Rent relief: 20% of rent, capped at 500,000
      let rentRelief = rent * 0.20;
      if (rentRelief > 500000) rentRelief = 500000;

      // Adjusted income after deductions
      let adj = gross - deductions - rentRelief;
      if (adj < 0) adj = 0;

      // If adj ≤ 800,000 → no tax
      let tax = 0;
      if (adj > 800000) {
        let taxable = adj;
        function taxSlice(amount, rate) { return amount * rate; }
        let remaining = taxable - 800000;
        if (remaining > 0) {
          let slice = Math.min(remaining, 3000000 - 800000);
          tax += taxSlice(slice, 0.15);
          remaining -= slice;
        }
        if (remaining > 0) {
          let slice = Math.min(remaining, 12000000 - 3000000);
          tax += taxSlice(slice, 0.18);
          remaining -= slice;
        }
        if (remaining > 0) {
          let slice = Math.min(remaining, 25000000 - 12000000);
          tax += taxSlice(slice, 0.21);
          remaining -= slice;
        }
        if (remaining > 0) {
          let slice = Math.min(remaining, 50000000 - 25000000);
          tax += taxSlice(slice, 0.23);
          remaining -= slice;
        }
        if (remaining > 0) {
          tax += taxSlice(remaining, 0.25);
        }
      }

      let effRate = gross > 0 ? (tax / gross) * 100 : 0;
      let netSavings = gross - expenses;

      document.getElementById('result').innerHTML =
        `<p><strong>Summary:</strong></p>
         <p>Total gross annual income: ₦${gross.toLocaleString()}</p>
         <p>Total deductions: ₦${deductions.toLocaleString()}</p>
         <p>Total expenses: ₦${expenses.toLocaleString()}</p>
         <p>Rent relief: ₦${rentRelief.toLocaleString()}</p>
         <p>Taxable income after deductions: ₦${adj.toLocaleString()}</p>
         <p><strong>Tax payable:</strong> ₦${tax.toLocaleString(undefined, {maximumFractionDigits:0})}</p>
         <p>Effective tax rate on gross income: ${effRate.toFixed(2)}%</p>
         <hr/>
         <p><strong>Net position (Income - Expenses): ₦${netSavings.toLocaleString()}</strong></p>
         ${adj <= 800000 ? `<p><strong>No tax payable</strong> (taxable income ₦${adj.toLocaleString()}).</p>` : ""}
        `;
    }
  </script>
</body>
</html>
